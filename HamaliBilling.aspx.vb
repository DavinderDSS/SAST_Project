Imports System
Imports System.Data
Imports System.Data.SqlClient
Imports System.IO
Imports System.Text.RegularExpressions
Partial Class HamaliBilling
    Inherits System.Web.UI.Page
    Implements System.Web.UI.ICallbackEventHandler
    Protected returnValue As New StringBuilder
    ''for Billing
    Dim BagWight As Decimal = 0
    Dim Number As Decimal = 0
    Dim Rate As Decimal = 0
    Dim Amount As Decimal = 0
    ''To get the page details used this and this is for Audit trail issue detail point added this on 01-12-2019
    Dim RAffected As Integer = 0
    Dim ModuleName As String = String.Empty
    ''To get the page details used this and this is for Audit trail issue detail point added this on 01-12-2019

    '''' This Should Add on every Page and this is added for server banner point 25-12-2019
    Protected Sub Application_PreSendRequestHeaders()
        Response.Headers.Remove("Server") ''Commneted this on 23-12-2019 as error occure
        Response.Headers.Remove("X-AspNet-Version") ''ASP.NET Response Headers GIS Issue added on 03-01-2020
        Response.AddHeader("Sample1", "Value1")
    End Sub
    '''' This Should Add on every Page and this is added for server banner point 25-12-2019

    ''---------------Befor Page Load
    '''' This is for getting the value of VSUK added this on 11-11-2019
    Protected Overrides Sub OnInit(ByVal e As EventArgs)

        MyBase.OnInit(e)
        ''''CSRFUserKey = ViewStateUserKey
        ''Call GetDataByDr("select top 1 CSRFUserKey from CCF_User_Activity_TrackBackUp111119 where offline='No' and SessionID='" & Session("SID") & "' and User_staffid='" & Session("staffid") & "' and CSRFUserKey IS NOT NULL and LogOutDateTime IS NULL order by AccessDateTime desc")
        ''If DataDr.HasRows Then
        ''    While DataDr.Read
        ''        CSRFUK = DataDr("CSRFUserKey")
        ''    End While
        ''End If
        ''DataDr.Close()

        CSRFUK = GetMySQLAValue("select top 1 CSRFUserKey from Hamali_User_Activity_Track where offline='No' and SessionID='" & Session("SID") & "' and User_staffid='" & Session("staffid") & "' and CSRFUserKey IS NOT NULL and LogOutDateTime IS NULL order by AccessDateTime desc")
        ''Session Fixation issue code added on 26-12-2019 is as below 
        AuthTokennDtl = GetMySQLAValue("select top 1 AuthToken from Hamali_User_Activity_Track where offline='No' and SessionID='" & Session("SID") & "' and User_staffid='" & Session("staffid") & "' and CSRFUserKey IS NOT NULL and LogOutDateTime IS NULL order by AccessDateTime desc")
        ''Session Fixation issue code added on 26-12-2019 is as below 
    End Sub
    '''' Qry is ended here added for VSUK added this on 11-11-2019

    Protected Sub form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles form1.Load
        Try

            Application_PreSendRequestHeaders() '''' This Should Add on every Page and this is added for server banner point 25-12-2019

            ''This is used to deactivate the browser back button on respective page added this on 13-05-2020
            ClientScript.RegisterClientScriptBlock(Page.GetType, "NOBACK", "<script>if(history.length>0)history.go(+1);</script>")
            ''Code is ended here added on 13-05-2020


            ''Qry to redirect the user if he not have the rights / CSRF validation page wise added this on 12-11-2019
            If CSRFUK = Session("CSRFUKSIDNew") And AuthTokennDtl.ToString.Equals(Request.Cookies("AuthToken").Value) Then   ''This is for else actule live usage   '' Added And obj.AuthTokennDtl.ToString.Equals(Request.Cookies("AuthToken").Value) in  if on 23-12-2019 ''''Session("AuthToken").ToString.Equals(Request.Cookies("AuthToken").Value)  
                ''If CSRFUK = Session("CSRFUKSID") Then ''This is for else testing usage

                If Session("Role").ToString = "PlantOfficer" Then   ''Role wise page Autherity option Added this Code on 08-11-2019
                    If Not IsPostBack Then

                        ''To get the page details used this and this is for Audit trail issue detail point added this on 10-12-2019
                        ModuleName = Page.GetType.Name.Split("_")("0")
                        RAffected = SaveCmplntData("Insert Into Hamali_User_Activity_AuditTrail(User_staffid,User_initial,emp_plantNm,emp_plantCode,emp_Role,AccessDateTime,SessionID,CSRFUserKey,CSRFUserKeyDtlCopy,UserIPAddressDtl,ModuleName) Values ('" & Session("staffid") & "', '" & Session("initial") & "','" & Session("plantName") & "','" & Session("plantCode") & "', '" & Session("Role") & "',getdate(),'" & Session("SID") & "','" & Session("CSRFUKSIDNew") & "','" & Session("CSRFUKSIDNew") & "', '" & Session("UserIPAddressDtl") & "', '" & ModuleName & "')")
                        ''To get the page details used this and this is for Audit trail issue detail point added this on 10-12-2019

                        GetDataByQUERY("select Contractor_Code,Contractor_Name from Hamali_Contractor_master where plant_code='" & Session("plantCode") & "' order by Contractor_Code", cmbContractor, "Contractor_Name", "Contractor_code")

                    End If


                    HiddenFieldPC.Value = Session("plantCode")
                    HiddenFieldPlantName.Value = Session("plantName")

                    Dim cbReference As String
                    cbReference = Page.ClientScript.GetCallbackEventReference(Me, "arg", "ReceiveServerData", "context")
                    Dim callbackScript As String = ""
                    callbackScript &= "function CallServer(arg, context) { " & cbReference & "} ;"
                    Page.ClientScript.RegisterClientScriptBlock(Me.GetType(), "CallServer", callbackScript, True)

                    'gvBilling.DataSource = Nothing
                    'gvBilling.DataBind()
                    'gvBilling.Visible = False
                Else ''Role wise page Autherity option Added this Code on 08-11-2019 and below line of code                    
                    ClientScript.RegisterStartupScript(Me.GetType(), "Redirect", "window.onload = function(){ alert('You do not have the rights to access this Page / Form');window.location='MenuPage.aspx'; }", True)
                End If  ''Role wise page Autherity option Added this Code on 08-11-2019

            Else ''Role wise page Autherity option Added this Code on 12-11-2019 and below line of code

                Response.Write("<script language='javascript'>window.alert('Be careful.... You do not have the rights to access this Page / Form');window.location='MenuPage.aspx';</script>")

            End If ''This line of code is added on 12-11-2019 for CSRF validation

        Catch ex As Exception
            ''MsgBox(ex.Message) ''Commented this on 09-12-2019 as this MsgBox will create the concer Showing a modal dialog box or form when the application is not running in UserInteractive mode is not a valid operation. Specify the ServiceNotification or DefaultDesktopOnly style to display a notification from a service application.
            Response.Write("<script language='javascript'>window.alert('Invalid Values');window.location='MenuPage.aspx';</script>")
        Finally
            If con.State = Data.ConnectionState.Open Then con.Close()
        End Try

    End Sub

    Public Function GetCallbackResult() As String Implements System.Web.UI.ICallbackEventHandler.GetCallbackResult
        Return returnValue.ToString
    End Function
    Public Sub RaiseCallbackEvent(ByVal eventArgument As String) Implements System.Web.UI.ICallbackEventHandler.RaiseCallbackEvent

        Try
            If eventArgument Is Nothing Then
                returnValue.Append("-1")
            Else
                Dim s = eventArgument.Split("#")

                Select Case s(0).ToString

                    Case "Fifth"
                        Dim v = s(1).ToString.Split("|")
                        Dim qry As String = String.Empty

                        'qry = "Exec HamaliBilling " & v(0).ToString & "," & v(1).ToString & "," & v(2).ToString & "," & v(3).ToString & "," & v(4).ToString & ""
                        If Session("plantCode").ToString = "1157" Then

                            qry = "SELECT ht.crop_type as Section,1 as ActNo,ham.activity +'__'+'Loading' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.loading) as Number,hrm.loading as Rate,SUM(ht.loading * hrm.loading) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.loading <> 0 and hrm.loading <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.loading,hrm.loading union all SELECT ht.crop_type as Section,2 as ActNo,ham.activity +'__'+'UnLoading' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.unloading) as Number,hrm.unloading as Rate,SUM(ht.unloading * hrm.unloading) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unloading <> 0 and hrm.unloading <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.unloading,hrm.unloading union all SELECT ht.crop_type as Section,3 as ActNo,ham.activity +'__'+'Sorting' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.sorting) as Number,hrm.sorting as Rate,SUM(ht.sorting * hrm.sorting) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.sorting <> 0 and hrm.sorting <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.sorting,hrm.sorting union all SELECT ht.crop_type as Section,4 as ActNo,ham.activity +'__'+'Stiching' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.stiching) as Number,hrm.stiching as Rate,SUM(ht.stiching * hrm.stiching) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.stiching <> 0 and hrm.stiching <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.stiching,hrm.stiching union all SELECT ht.crop_type as Section,5 as ActNo,ham.activity +'__'+'Stacking' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.stacking) as Number,hrm.stacking as Rate,SUM(ht.stacking * hrm.stacking) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.stacking <> 0 and hrm.stacking <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.stacking,hrm.stacking union all SELECT ht.crop_type as Section,6 as ActNo,ham.activity +'__'+'Restacking' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.restacking) as Number,hrm.restacking as Rate,SUM(ht.restacking * hrm.restacking) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.restacking <> 0 and hrm.restacking <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.restacking,hrm.restacking union all SELECT ht.crop_type as Section,7 as ActNo,ham.activity +'__'+'Weighing' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.weighing) as Number,hrm.weighing as Rate,SUM(ht.weighing * hrm.weighing) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.weighing <> 0 and hrm.weighing <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.weighing,hrm.weighing union all SELECT ht.crop_type as Section,8 as ActNo,ham.activity +'__'+'Bundle_Preparation' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.bundle_preparation) as Number,hrm.bundle_preparation as Rate,SUM(ht.bundle_preparation * hrm.bundle_preparation) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.bundle_preparation <> 0 and hrm.bundle_preparation <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.bundle_preparation,hrm.bundle_preparation union all SELECT ht.crop_type as Section,9 as ActNo,ham.activity +'__'+'Opening_Feeding' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.opening_feeding) as Number,hrm.opening_feeding as Rate,SUM(ht.opening_feeding * hrm.opening_feeding) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.opening_feeding <> 0 and hrm.opening_feeding <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.opening_feeding,hrm.opening_feeding union all SELECT ht.crop_type as Section,10 as ActNo,ham.activity +'__'+'Loading_Unloading' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.loading_unloading) as Number,hrm.loading_unloading as Rate,SUM(ht.loading_unloading * hrm.loading_unloading) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.loading_unloading <> 0 and hrm.loading_unloading <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.loading_unloading,hrm.loading_unloading union all SELECT ht.crop_type as Section,11 as ActNo,ham.activity +'__'+'UnLoad_Stack' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.UnLoad_Stack) as Number,hrm.UnLoad_Stack as Rate,SUM(ht.UnLoad_Stack * hrm.UnLoad_Stack) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.UnLoad_Stack <> 0 and hrm.UnLoad_Stack <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.UnLoad_Stack,hrm.UnLoad_Stack union all SELECT ht.crop_type as Section,12 as ActNo,ham.activity +'__'+'Unp_Recd_Unl_Wt_Stk' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.unp_recd_unl_wt_stk) as Number,hrm.unp_recd_unl_wt_stk as Rate,SUM(ht.unp_recd_unl_wt_stk * hrm.unp_recd_unl_wt_stk) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unp_recd_unl_wt_stk <> 0 and hrm.unp_recd_unl_wt_stk <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.unp_recd_unl_wt_stk,hrm.unp_recd_unl_wt_stk union all SELECT ht.crop_type as Section,13 as ActNo,ham.activity +'__'+'Unp_Recd_Unl_Srt_Wt_Stk' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.unp_recd_unl_srt_wt_stk) as Number,hrm.unp_recd_unl_srt_wt_stk as Rate,SUM(ht.unp_recd_unl_srt_wt_stk * hrm.unp_recd_unl_srt_wt_stk) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unp_recd_unl_srt_wt_stk <> 0 and hrm.unp_recd_unl_srt_wt_stk <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.unp_recd_unl_srt_wt_stk,hrm.unp_recd_unl_srt_wt_stk union all SELECT ht.crop_type as Section,14 as ActNo,ham.activity +'__'+'Dh_To_Ac_Stk' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.dh_to_ac_stk) as Number,hrm.dh_to_ac_stk as Rate,SUM(ht.dh_to_ac_stk * hrm.dh_to_ac_stk) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.dh_to_ac_stk <> 0 and hrm.dh_to_ac_stk <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.dh_to_ac_stk,hrm.dh_to_ac_stk union all SELECT ht.crop_type as Section,15 as ActNo,ham.activity +'__'+'Ac_To_Dh_Stk' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.ac_to_dh_stk) as Number,hrm.ac_to_dh_stk as Rate,SUM(ht.ac_to_dh_stk * hrm.ac_to_dh_stk) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.ac_to_dh_stk <> 0 and hrm.ac_to_dh_stk <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.ac_to_dh_stk,hrm.ac_to_dh_stk union all SELECT ht.crop_type as Section,16 as ActNo,ham.activity +'__'+'Loading_Dh' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.loading_dh) as Number,hrm.loading_dh as Rate,SUM(ht.loading_dh * hrm.loading_dh) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.loading_dh <> 0 and hrm.loading_dh <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.loading_dh,hrm.loading_dh union all SELECT ht.crop_type as Section,17 as ActNo,ham.activity +'__'+'UnLoading_Dh' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.unloading_dh) as Number,hrm.unloading_dh as Rate,SUM(ht.unloading_dh * hrm.unloading_dh) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unloading_dh <> 0 and hrm.unloading_dh <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.unloading_dh,hrm.unloading_dh union all SELECT ht.crop_type as Section,18 as ActNo,ham.activity +'__'+'Varai' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.varai) as Number,hrm.varai as Rate,SUM(ht.varai * hrm.varai) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.varai <> 0 and hrm.varai <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.varai,hrm.varai order by ht.crop_type"

                            Call GetDataByDr(qry)
                            If DataDr.HasRows Then
                                GridView1.DataSource = DataDr
                                GridView1.DataBind()
                            End If
                            DataDr.Close()
                            DataDr = Nothing
                            con.Close()


                            For Each Title As GridViewRow In GridView1.Rows
                                Title.Cells(0).Attributes.Add("Title", "SrNo")
                                Title.Cells(1).Attributes.Add("Title", "Section")
                                Title.Cells(2).Attributes.Add("Title", "ActNo")
                                Title.Cells(3).Attributes.Add("Title", "Operation_Activities")
                                Title.Cells(4).Attributes.Add("Title", "Bag_Weight")
                                Title.Cells(5).Attributes.Add("Title", "Distance_Range")
                                Title.Cells(6).Attributes.Add("Title", "Number")
                                Title.Cells(7).Attributes.Add("Title", "Rate")
                                Title.Cells(8).Attributes.Add("Title", "Amount_Rs")
                            Next

                            '*****code s end here

                            Dim sw1 As New StringWriter
                            Dim htw1 As New HtmlTextWriter(sw1)
                            GridView1.RenderControl(htw1)
                            returnValue.Append("Fifth|")
                            returnValue.Append(sw1.ToString())

                        Else

                            qry = "SELECT ht.crop_type as Section,1 as ActNo,ham.activity +'__'+'Loading' as Operation_Activities,ht.Bag_Weight,sum(ht.loading) as Number,hrm.loading as Rate,SUM(ht.loading * hrm.loading) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.loading <> 0 and hrm.loading <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.loading,hrm.loading union all SELECT ht.crop_type as Section,2 as ActNo,ham.activity +'__'+'UnLoading' as Operation_Activities,ht.Bag_Weight,sum(ht.unloading) as Number,hrm.unloading as Rate,SUM(ht.unloading * hrm.unloading) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unloading <> 0 and hrm.unloading <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.unloading,hrm.unloading union all SELECT ht.crop_type as Section,3 as ActNo,ham.activity +'__'+'Sorting' as Operation_Activities,ht.Bag_Weight,sum(ht.sorting) as Number,hrm.sorting as Rate,SUM(ht.sorting * hrm.sorting) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.sorting <> 0 and hrm.sorting <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.sorting,hrm.sorting union all SELECT ht.crop_type as Section,4 as ActNo,ham.activity +'__'+'Stiching' as Operation_Activities,ht.Bag_Weight,sum(ht.stiching) as Number,hrm.stiching as Rate,SUM(ht.stiching * hrm.stiching) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.stiching <> 0 and hrm.stiching <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.stiching,hrm.stiching union all SELECT ht.crop_type as Section,5 as ActNo,ham.activity +'__'+'Stacking' as Operation_Activities,ht.Bag_Weight,sum(ht.stacking) as Number,hrm.stacking as Rate,SUM(ht.stacking * hrm.stacking) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.stacking <> 0 and hrm.stacking <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.stacking,hrm.stacking union all SELECT ht.crop_type as Section,6 as ActNo,ham.activity +'__'+'Restacking' as Operation_Activities,ht.Bag_Weight,sum(ht.restacking) as Number,hrm.restacking as Rate,SUM(ht.restacking * hrm.restacking) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.restacking <> 0 and hrm.restacking <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.restacking,hrm.restacking union all SELECT ht.crop_type as Section,7 as ActNo,ham.activity +'__'+'Weighing' as Operation_Activities,ht.Bag_Weight,sum(ht.weighing) as Number,hrm.weighing as Rate,SUM(ht.weighing * hrm.weighing) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.weighing <> 0 and hrm.weighing <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.weighing,hrm.weighing union all SELECT ht.crop_type as Section,8 as ActNo,ham.activity +'__'+'Bundle_Preparation' as Operation_Activities,ht.Bag_Weight,sum(ht.bundle_preparation) as Number,hrm.bundle_preparation as Rate,SUM(ht.bundle_preparation * hrm.bundle_preparation) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.bundle_preparation <> 0 and hrm.bundle_preparation <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.bundle_preparation,hrm.bundle_preparation union all SELECT ht.crop_type as Section,9 as ActNo,ham.activity +'__'+'Opening_Feeding' as Operation_Activities,ht.Bag_Weight,sum(ht.opening_feeding) as Number,hrm.opening_feeding as Rate,SUM(ht.opening_feeding * hrm.opening_feeding) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.opening_feeding <> 0 and hrm.opening_feeding <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.opening_feeding,hrm.opening_feeding union all SELECT ht.crop_type as Section,10 as ActNo,ham.activity +'__'+'Loading_Unloading' as Operation_Activities,ht.Bag_Weight,sum(ht.loading_unloading) as Number,hrm.loading_unloading as Rate,SUM(ht.loading_unloading * hrm.loading_unloading) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.loading_unloading <> 0 and hrm.loading_unloading <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.loading_unloading,hrm.loading_unloading union all SELECT ht.crop_type as Section,11 as ActNo,ham.activity +'__'+'UnLoad_Stack' as Operation_Activities,ht.Bag_Weight,sum(ht.UnLoad_Stack) as Number,hrm.UnLoad_Stack as Rate,SUM(ht.UnLoad_Stack * hrm.UnLoad_Stack) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.UnLoad_Stack <> 0 and hrm.UnLoad_Stack <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.UnLoad_Stack,hrm.UnLoad_Stack union all SELECT ht.crop_type as Section,12 as ActNo,ham.activity +'__'+'Unp_Recd_Unl_Wt_Stk' as Operation_Activities,ht.Bag_Weight,sum(ht.unp_recd_unl_wt_stk) as Number,hrm.unp_recd_unl_wt_stk as Rate,SUM(ht.unp_recd_unl_wt_stk * hrm.unp_recd_unl_wt_stk) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unp_recd_unl_wt_stk <> 0 and hrm.unp_recd_unl_wt_stk <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.unp_recd_unl_wt_stk,hrm.unp_recd_unl_wt_stk union all SELECT ht.crop_type as Section,13 as ActNo,ham.activity +'__'+'Unp_Recd_Unl_Srt_Wt_Stk' as Operation_Activities,ht.Bag_Weight,sum(ht.unp_recd_unl_srt_wt_stk) as Number,hrm.unp_recd_unl_srt_wt_stk as Rate,SUM(ht.unp_recd_unl_srt_wt_stk * hrm.unp_recd_unl_srt_wt_stk) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unp_recd_unl_srt_wt_stk <> 0 and hrm.unp_recd_unl_srt_wt_stk <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.unp_recd_unl_srt_wt_stk,hrm.unp_recd_unl_srt_wt_stk union all SELECT ht.crop_type as Section,14 as ActNo,ham.activity +'__'+'Dh_To_Ac_Stk' as Operation_Activities,ht.Bag_Weight,sum(ht.dh_to_ac_stk) as Number,hrm.dh_to_ac_stk as Rate,SUM(ht.dh_to_ac_stk * hrm.dh_to_ac_stk) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.dh_to_ac_stk <> 0 and hrm.dh_to_ac_stk <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.dh_to_ac_stk,hrm.dh_to_ac_stk union all SELECT ht.crop_type as Section,15 as ActNo,ham.activity +'__'+'Ac_To_Dh_Stk' as Operation_Activities,ht.Bag_Weight,sum(ht.ac_to_dh_stk) as Number,hrm.ac_to_dh_stk as Rate,SUM(ht.ac_to_dh_stk * hrm.ac_to_dh_stk) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.ac_to_dh_stk <> 0 and hrm.ac_to_dh_stk <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.ac_to_dh_stk,hrm.ac_to_dh_stk union all SELECT ht.crop_type as Section,16 as ActNo,ham.activity +'__'+'Loading_Dh' as Operation_Activities,ht.Bag_Weight,sum(ht.loading_dh) as Number,hrm.loading_dh as Rate,SUM(ht.loading_dh * hrm.loading_dh) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.loading_dh <> 0 and hrm.loading_dh <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.loading_dh,hrm.loading_dh union all SELECT ht.crop_type as Section,17 as ActNo,ham.activity +'__'+'UnLoading_Dh' as Operation_Activities,ht.Bag_Weight,sum(ht.unloading_dh) as Number,hrm.unloading_dh as Rate,SUM(ht.unloading_dh * hrm.unloading_dh) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unloading_dh <> 0 and hrm.unloading_dh <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.unloading_dh,hrm.unloading_dh union all SELECT ht.crop_type as Section,18 as ActNo,ham.activity +'__'+'Varai' as Operation_Activities,ht.Bag_Weight,sum(ht.varai) as Number,hrm.varai as Rate,SUM(ht.varai * hrm.varai) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.varai <> 0 and hrm.varai <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.varai,hrm.varai union all SELECT ht.crop_type as Section,19 as ActNo,ham.activity +'__'+'Stitch_Stack_Plant_OP_Spc_Dry' as Operation_Activities,ht.Bag_Weight,sum(ht.Stitch_Stack_Plant_OP_Spc_Dry) as Number,hrm.Stitch_Stack_Plant_OP_Spc_Dry as Rate,SUM(ht.Stitch_Stack_Plant_OP_Spc_Dry * hrm.Stitch_Stack_Plant_OP_Spc_Dry) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.Stitch_Stack_Plant_OP_Spc_Dry <> 0 and hrm.Stitch_Stack_Plant_OP_Spc_Dry <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,ht.Stitch_Stack_Plant_OP_Spc_Dry,hrm.Stitch_Stack_Plant_OP_Spc_Dry order by ht.crop_type"

                            'qry = "SELECT ht.crop_type as Section,1 as ActNo,'Loading' as Activities,ht.Bag_Weight,ht.loading as Number,hrm.loading as Rate,SUM(ht.loading * hrm.loading) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.loading <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.loading,hrm.loading union all SELECT ht.crop_type as Section,2 as ActNo,'UnLoading' as Activities,ht.Bag_Weight,ht.unloading as Number,hrm.unloading as Rate,SUM(ht.unloading * hrm.unloading) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unloading <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.unloading,hrm.unloading union all SELECT ht.crop_type as Section,3 as ActNo,'Sorting' as Activities,ht.Bag_Weight,ht.sorting as Number,hrm.sorting as Rate,SUM(ht.sorting * hrm.sorting) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.sorting <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.sorting,hrm.sorting union all SELECT ht.crop_type as Section,4 as ActNo,'Stiching' as Activities,ht.Bag_Weight,ht.stiching as Number,hrm.stiching as Rate,SUM(ht.stiching * hrm.stiching) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.stiching <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.stiching,hrm.stiching union all SELECT ht.crop_type as Section,5 as ActNo,'Stacking' as Activities,ht.Bag_Weight,ht.stacking as Number,hrm.stacking as Rate,SUM(ht.stacking * hrm.stacking) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.stacking <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.stacking,hrm.stacking union all SELECT ht.crop_type as Section,6 as ActNo,'Restacking' as Activities,ht.Bag_Weight,ht.restacking as Number,hrm.restacking as Rate,SUM(ht.restacking * hrm.restacking) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.restacking <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.restacking,hrm.restacking union all SELECT ht.crop_type as Section,7 as ActNo,'Weighing' as Activities,ht.Bag_Weight,ht.weighing as Number,hrm.weighing as Rate,SUM(ht.weighing * hrm.weighing) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.weighing <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.weighing,hrm.weighing union all SELECT ht.crop_type as Section,8 as ActNo,'Bundle_Preparation' as Activities,ht.Bag_Weight,ht.bundle_preparation as Number,hrm.bundle_preparation as Rate,SUM(ht.bundle_preparation * hrm.bundle_preparation) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.bundle_preparation <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.bundle_preparation,hrm.bundle_preparation union all SELECT ht.crop_type as Section,9 as ActNo,'Opening_Feeding' as Activities,ht.Bag_Weight,ht.opening_feeding as Number,hrm.opening_feeding as Rate,SUM(ht.opening_feeding * hrm.opening_feeding) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.opening_feeding <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.opening_feeding,hrm.opening_feeding union all SELECT ht.crop_type as Section,10 as ActNo,'Loading_Unloading' as Activities,ht.Bag_Weight,ht.loading_unloading as Number,hrm.loading_unloading as Rate,SUM(ht.loading_unloading * hrm.loading_unloading) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.loading_unloading <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.loading_unloading,hrm.loading_unloading union all SELECT ht.crop_type as Section,11 as ActNo,'Unp_Recd_Unl_Wt_Stk' as Activities,ht.Bag_Weight,ht.unp_recd_unl_wt_stk as Number,hrm.unp_recd_unl_wt_stk as Rate,SUM(ht.unp_recd_unl_wt_stk * hrm.unp_recd_unl_wt_stk) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unp_recd_unl_wt_stk <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.unp_recd_unl_wt_stk,hrm.unp_recd_unl_wt_stk union all SELECT ht.crop_type as Section,12 as ActNo,'Unp_Recd_Unl_Srt_Wt_Stk' as Activities,ht.Bag_Weight,ht.unp_recd_unl_srt_wt_stk as Number,hrm.unp_recd_unl_srt_wt_stk as Rate,SUM(ht.unp_recd_unl_srt_wt_stk * hrm.unp_recd_unl_srt_wt_stk) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unp_recd_unl_srt_wt_stk <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.unp_recd_unl_srt_wt_stk,hrm.unp_recd_unl_srt_wt_stk union all SELECT ht.crop_type as Section,13 as ActNo,'Dh_To_Ac_Stk' as Activities,ht.Bag_Weight,ht.dh_to_ac_stk as Number,hrm.dh_to_ac_stk as Rate,SUM(ht.dh_to_ac_stk * hrm.dh_to_ac_stk) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.dh_to_ac_stk <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.dh_to_ac_stk,hrm.dh_to_ac_stk union all SELECT ht.crop_type as Section,14 as ActNo,'Ac_To_Dh_Stk' as Activities,ht.Bag_Weight,ht.ac_to_dh_stk as Number,hrm.ac_to_dh_stk as Rate,SUM(ht.ac_to_dh_stk * hrm.ac_to_dh_stk) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.ac_to_dh_stk <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.ac_to_dh_stk,hrm.ac_to_dh_stk union all SELECT ht.crop_type as Section,15 as ActNo,'Loading_Dh' as Activities,ht.Bag_Weight,ht.loading_dh as Number,hrm.loading_dh as Rate,SUM(ht.loading_dh * hrm.loading_dh) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.loading_dh <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.loading_dh,hrm.loading_dh union all SELECT ht.crop_type as Section,16 as ActNo,'UnLoading_Dh' as Activities,ht.Bag_Weight,ht.unloading_dh as Number,hrm.unloading_dh as Rate,SUM(ht.unloading_dh * hrm.unloading_dh) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unloading_dh <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.unloading_dh,hrm.unloading_dh union all SELECT ht.crop_type as Section,17 as ActNo,'Varai' as Activities,ht.Bag_Weight,ht.varai as Number,hrm.varai as Rate,SUM(ht.varai * hrm.varai) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.varai <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.varai,hrm.varai order by ht.crop_type"

                            Call GetDataByDr(qry)
                            If DataDr.HasRows Then
                                GridView1.DataSource = DataDr
                                GridView1.DataBind()
                            End If
                            DataDr.Close()
                            DataDr = Nothing
                            con.Close()


                            For Each Title As GridViewRow In GridView1.Rows
                                Title.Cells(0).Attributes.Add("Title", "SrNo")
                                Title.Cells(1).Attributes.Add("Title", "Section")
                                Title.Cells(2).Attributes.Add("Title", "ActNo")
                                Title.Cells(3).Attributes.Add("Title", "Operation_Activities")
                                Title.Cells(4).Attributes.Add("Title", "Bag_Weight")
                                'Title.Cells(5).Attributes.Add("Title", "Distance_Range")
                                Title.Cells(5).Attributes.Add("Title", "Number")
                                Title.Cells(6).Attributes.Add("Title", "Rate")
                                Title.Cells(7).Attributes.Add("Title", "Amount_Rs")
                            Next

                            '*****code s end here

                            Dim sw1 As New StringWriter
                            Dim htw1 As New HtmlTextWriter(sw1)
                            GridView1.RenderControl(htw1)
                            returnValue.Append("Fifth|")
                            returnValue.Append(sw1.ToString())


                        End If


                    Case "Sixth"
                        Dim v = s(1).ToString.Split("|")
                        Dim qry As String = String.Empty

                        'qry = "Exec HamaliBilling " & v(0).ToString & "," & v(1).ToString & "," & v(2).ToString & "," & v(3).ToString & "," & v(4).ToString & ""
                        If Session("plantCode").ToString = "1157" Then

                            qry = "SELECT ht.crop_type as Section,1 as ActNo,ham.activity +'__'+'Loading' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.loading) as Number,hrm.loading as Rate,SUM(ht.loading * hrm.loading) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.loading <> 0 and hrm.loading <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.loading union all SELECT ht.crop_type as Section,2 as ActNo,ham.activity +'__'+'UnLoading' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.unloading) as Number,hrm.unloading as Rate,SUM(ht.unloading * hrm.unloading) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unloading <> 0 and hrm.unloading <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.unloading union all SELECT ht.crop_type as Section,3 as ActNo,ham.activity +'__'+'Sorting' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.sorting) as Number,hrm.sorting as Rate,SUM(ht.sorting * hrm.sorting) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.sorting <> 0 and hrm.sorting <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.sorting union all SELECT ht.crop_type as Section,4 as ActNo,ham.activity +'__'+'Stiching' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.stiching) as Number,hrm.stiching as Rate,SUM(ht.stiching * hrm.stiching) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.stiching <> 0 and hrm.stiching <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.stiching union all SELECT ht.crop_type as Section,5 as ActNo,ham.activity +'__'+'Stacking' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.stacking) as Number,hrm.stacking as Rate,SUM(ht.stacking * hrm.stacking) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.stacking <> 0 and hrm.stacking <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.stacking union all SELECT ht.crop_type as Section,6 as ActNo,ham.activity +'__'+'Restacking' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.restacking) as Number,hrm.restacking as Rate,SUM(ht.restacking * hrm.restacking) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.restacking <> 0 and hrm.restacking <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.restacking union all SELECT ht.crop_type as Section,7 as ActNo,ham.activity +'__'+'Weighing' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.weighing) as Number,hrm.weighing as Rate,SUM(ht.weighing * hrm.weighing) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.weighing <> 0 and hrm.weighing <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.weighing union all SELECT ht.crop_type as Section,8 as ActNo,ham.activity +'__'+'Bundle_Preparation' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.bundle_preparation) as Number,hrm.bundle_preparation as Rate,SUM(ht.bundle_preparation * hrm.bundle_preparation) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.bundle_preparation <> 0 and hrm.bundle_preparation <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.bundle_preparation union all SELECT ht.crop_type as Section,9 as ActNo,ham.activity +'__'+'Opening_Feeding' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.opening_feeding) as Number,hrm.opening_feeding as Rate,SUM(ht.opening_feeding * hrm.opening_feeding) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.opening_feeding <> 0 and hrm.opening_feeding <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.opening_feeding union all SELECT ht.crop_type as Section,10 as ActNo,ham.activity +'__'+'Loading_Unloading' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.loading_unloading) as Number,hrm.loading_unloading as Rate,SUM(ht.loading_unloading * hrm.loading_unloading) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.loading_unloading <> 0 and hrm.loading_unloading <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.loading_unloading union all SELECT ht.crop_type as Section,11 as ActNo,ham.activity +'__'+'UnLoad_Stack' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.UnLoad_Stack) as Number,hrm.UnLoad_Stack as Rate,SUM(ht.UnLoad_Stack * hrm.UnLoad_Stack) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.UnLoad_Stack <> 0 and hrm.UnLoad_Stack <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.UnLoad_Stack union all SELECT ht.crop_type as Section,12 as ActNo,ham.activity +'__'+'Unp_Recd_Unl_Wt_Stk' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.unp_recd_unl_wt_stk) as Number,hrm.unp_recd_unl_wt_stk as Rate,SUM(ht.unp_recd_unl_wt_stk * hrm.unp_recd_unl_wt_stk) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unp_recd_unl_wt_stk <> 0 and hrm.unp_recd_unl_wt_stk <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.unp_recd_unl_wt_stk union all SELECT ht.crop_type as Section,13 as ActNo,ham.activity +'__'+'Unp_Recd_Unl_Srt_Wt_Stk' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.unp_recd_unl_srt_wt_stk) as Number,hrm.unp_recd_unl_srt_wt_stk as Rate,SUM(ht.unp_recd_unl_srt_wt_stk * hrm.unp_recd_unl_srt_wt_stk) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unp_recd_unl_srt_wt_stk <> 0 and hrm.unp_recd_unl_srt_wt_stk <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.unp_recd_unl_srt_wt_stk union all SELECT ht.crop_type as Section,14 as ActNo,ham.activity +'__'+'Dh_To_Ac_Stk' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.dh_to_ac_stk) as Number,hrm.dh_to_ac_stk as Rate,SUM(ht.dh_to_ac_stk * hrm.dh_to_ac_stk) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.dh_to_ac_stk <> 0 and hrm.dh_to_ac_stk <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.dh_to_ac_stk union all SELECT ht.crop_type as Section,15 as ActNo,ham.activity +'__'+'Ac_To_Dh_Stk' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.ac_to_dh_stk) as Number,hrm.ac_to_dh_stk as Rate,SUM(ht.ac_to_dh_stk * hrm.ac_to_dh_stk) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.ac_to_dh_stk <> 0 and hrm.ac_to_dh_stk <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.ac_to_dh_stk union all SELECT ht.crop_type as Section,16 as ActNo,ham.activity +'__'+'Loading_Dh' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.loading_dh) as Number,hrm.loading_dh as Rate,SUM(ht.loading_dh * hrm.loading_dh) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.loading_dh <> 0 and hrm.loading_dh <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.loading_dh union all SELECT ht.crop_type as Section,17 as ActNo,ham.activity +'__'+'UnLoading_Dh' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.unloading_dh) as Number,hrm.unloading_dh as Rate,SUM(ht.unloading_dh * hrm.unloading_dh) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unloading_dh <> 0 and hrm.unloading_dh <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.unloading_dh union all SELECT ht.crop_type as Section,18 as ActNo,ham.activity +'__'+'Varai' as Operation_Activities,ht.Bag_Weight,hdn.description as Distance_Range,sum(ht.varai) as Number,hrm.varai as Rate,SUM(ht.varai * hrm.varai) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.varai <> 0 and hrm.varai <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.varai order by ht.crop_type"

                            Call GetDataByDr(qry)
                            If DataDr.HasRows Then
                                GridView1.DataSource = DataDr
                                GridView1.DataBind()
                            End If
                            DataDr.Close()
                            DataDr = Nothing
                            con.Close()


                            For Each Title As GridViewRow In GridView1.Rows
                                Title.Cells(0).Attributes.Add("Title", "SrNo")
                                Title.Cells(1).Attributes.Add("Title", "Section")
                                Title.Cells(2).Attributes.Add("Title", "ActNo")
                                Title.Cells(3).Attributes.Add("Title", "Operation_Activities")
                                Title.Cells(4).Attributes.Add("Title", "Bag_Weight")
                                Title.Cells(5).Attributes.Add("Title", "Distance_Range")
                                Title.Cells(6).Attributes.Add("Title", "Number")
                                Title.Cells(7).Attributes.Add("Title", "Rate")
                                Title.Cells(8).Attributes.Add("Title", "Amount_Rs")
                            Next

                            '*****code s end here

                            Dim sw1 As New StringWriter
                            Dim htw1 As New HtmlTextWriter(sw1)
                            GridView1.RenderControl(htw1)
                            returnValue.Append("Sixth|")
                            returnValue.Append(sw1.ToString())

                        Else

                            qry = "SELECT ht.crop_type as Section,1 as ActNo,ham.activity +'__'+'Loading' as Operation_Activities,ht.Bag_Weight,sum(ht.loading) as Number,hrm.loading as Rate,SUM(ht.loading * hrm.loading) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.loading <> 0 and hrm.loading <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.loading union all SELECT ht.crop_type as Section,2 as ActNo,ham.activity +'__'+'UnLoading' as Operation_Activities,ht.Bag_Weight,sum(ht.unloading) as Number,hrm.unloading as Rate,SUM(ht.unloading * hrm.unloading) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unloading <> 0 and hrm.unloading <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.unloading union all SELECT ht.crop_type as Section,3 as ActNo,ham.activity +'__'+'Sorting' as Operation_Activities,ht.Bag_Weight,sum(ht.sorting) as Number,hrm.sorting as Rate,SUM(ht.sorting * hrm.sorting) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.sorting <> 0 and hrm.sorting <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.sorting union all SELECT ht.crop_type as Section,4 as ActNo,ham.activity +'__'+'Stiching' as Operation_Activities,ht.Bag_Weight,sum(ht.stiching) as Number,hrm.stiching as Rate,SUM(ht.stiching * hrm.stiching) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.stiching <> 0 and hrm.stiching <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.stiching union all SELECT ht.crop_type as Section,5 as ActNo,ham.activity +'__'+'Stacking' as Operation_Activities,ht.Bag_Weight,sum(ht.stacking) as Number,hrm.stacking as Rate,SUM(ht.stacking * hrm.stacking) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.stacking <> 0 and hrm.stacking <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.stacking union all SELECT ht.crop_type as Section,6 as ActNo,ham.activity +'__'+'Restacking' as Operation_Activities,ht.Bag_Weight,sum(ht.restacking) as Number,hrm.restacking as Rate,SUM(ht.restacking * hrm.restacking) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.restacking <> 0 and hrm.restacking <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.restacking union all SELECT ht.crop_type as Section,7 as ActNo,ham.activity +'__'+'Weighing' as Operation_Activities,ht.Bag_Weight,sum(ht.weighing) as Number,hrm.weighing as Rate,SUM(ht.weighing * hrm.weighing) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.weighing <> 0 and hrm.weighing <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.weighing union all SELECT ht.crop_type as Section,8 as ActNo,ham.activity +'__'+'Bundle_Preparation' as Operation_Activities,ht.Bag_Weight,sum(ht.bundle_preparation) as Number,hrm.bundle_preparation as Rate,SUM(ht.bundle_preparation * hrm.bundle_preparation) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.bundle_preparation <> 0 and hrm.bundle_preparation <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.bundle_preparation union all SELECT ht.crop_type as Section,9 as ActNo,ham.activity +'__'+'Opening_Feeding' as Operation_Activities,ht.Bag_Weight,sum(ht.opening_feeding) as Number,hrm.opening_feeding as Rate,SUM(ht.opening_feeding * hrm.opening_feeding) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.opening_feeding <> 0 and hrm.opening_feeding <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.opening_feeding union all SELECT ht.crop_type as Section,10 as ActNo,ham.activity +'__'+'Loading_Unloading' as Operation_Activities,ht.Bag_Weight,sum(ht.loading_unloading) as Number,hrm.loading_unloading as Rate,SUM(ht.loading_unloading * hrm.loading_unloading) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.loading_unloading <> 0 and hrm.loading_unloading <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.loading_unloading union all SELECT ht.crop_type as Section,11 as ActNo,ham.activity +'__'+'UnLoad_Stack' as Operation_Activities,ht.Bag_Weight,sum(ht.UnLoad_Stack) as Number,hrm.UnLoad_Stack as Rate,SUM(ht.UnLoad_Stack * hrm.UnLoad_Stack) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.UnLoad_Stack <> 0 and hrm.UnLoad_Stack <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.UnLoad_Stack union all SELECT ht.crop_type as Section,12 as ActNo,ham.activity +'__'+'Unp_Recd_Unl_Wt_Stk' as Operation_Activities,ht.Bag_Weight,sum(ht.unp_recd_unl_wt_stk) as Number,hrm.unp_recd_unl_wt_stk as Rate,SUM(ht.unp_recd_unl_wt_stk * hrm.unp_recd_unl_wt_stk) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unp_recd_unl_wt_stk <> 0 and hrm.unp_recd_unl_wt_stk <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.unp_recd_unl_wt_stk union all SELECT ht.crop_type as Section,13 as ActNo,ham.activity +'__'+'Unp_Recd_Unl_Srt_Wt_Stk' as Operation_Activities,ht.Bag_Weight,sum(ht.unp_recd_unl_srt_wt_stk) as Number,hrm.unp_recd_unl_srt_wt_stk as Rate,SUM(ht.unp_recd_unl_srt_wt_stk * hrm.unp_recd_unl_srt_wt_stk) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unp_recd_unl_srt_wt_stk <> 0 and hrm.unp_recd_unl_srt_wt_stk <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.unp_recd_unl_srt_wt_stk union all SELECT ht.crop_type as Section,14 as ActNo,ham.activity +'__'+'Dh_To_Ac_Stk' as Operation_Activities,ht.Bag_Weight,sum(ht.dh_to_ac_stk) as Number,hrm.dh_to_ac_stk as Rate,SUM(ht.dh_to_ac_stk * hrm.dh_to_ac_stk) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.dh_to_ac_stk <> 0 and hrm.dh_to_ac_stk <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.dh_to_ac_stk union all SELECT ht.crop_type as Section,15 as ActNo,ham.activity +'__'+'Ac_To_Dh_Stk' as Operation_Activities,ht.Bag_Weight,sum(ht.ac_to_dh_stk) as Number,hrm.ac_to_dh_stk as Rate,SUM(ht.ac_to_dh_stk * hrm.ac_to_dh_stk) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.ac_to_dh_stk <> 0 and hrm.ac_to_dh_stk <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.ac_to_dh_stk union all SELECT ht.crop_type as Section,16 as ActNo,ham.activity +'__'+'Loading_Dh' as Operation_Activities,ht.Bag_Weight,sum(ht.loading_dh) as Number,hrm.loading_dh as Rate,SUM(ht.loading_dh * hrm.loading_dh) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.loading_dh <> 0 and hrm.loading_dh <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.loading_dh union all SELECT ht.crop_type as Section,17 as ActNo,ham.activity +'__'+'UnLoading_Dh' as Operation_Activities,ht.Bag_Weight,sum(ht.unloading_dh) as Number,hrm.unloading_dh as Rate,SUM(ht.unloading_dh * hrm.unloading_dh) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unloading_dh <> 0 and hrm.unloading_dh <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.unloading_dh union all SELECT ht.crop_type as Section,18 as ActNo,ham.activity +'__'+'Varai' as Operation_Activities,ht.Bag_Weight,sum(ht.varai) as Number,hrm.varai as Rate,SUM(ht.varai * hrm.varai) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.varai <> 0 and hrm.varai <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.varai union all SELECT ht.crop_type as Section,19 as ActNo,ham.activity +'__'+'Stitch_Stack_Plant_OP_Spc_Dry' as Operation_Activities,ht.Bag_Weight,sum(ht.Stitch_Stack_Plant_OP_Spc_Dry) as Number,hrm.Stitch_Stack_Plant_OP_Spc_Dry as Rate,SUM(ht.Stitch_Stack_Plant_OP_Spc_Dry * hrm.Stitch_Stack_Plant_OP_Spc_Dry) AS Amount_Rs FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id  and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.Stitch_Stack_Plant_OP_Spc_Dry <> 0 and hrm.Stitch_Stack_Plant_OP_Spc_Dry <> 0 GROUP BY ht.crop_type,ham.activity,ht.Bag_Weight,hdn.description,hrm.Stitch_Stack_Plant_OP_Spc_Dry order by ht.crop_type"

                            'qry = "SELECT ht.crop_type as Section,1 as ActNo,'Loading' as Activities,ht.Bag_Weight,ht.loading as Number,hrm.loading as Rate,SUM(ht.loading * hrm.loading) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.loading <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.loading,hrm.loading union all SELECT ht.crop_type as Section,2 as ActNo,'UnLoading' as Activities,ht.Bag_Weight,ht.unloading as Number,hrm.unloading as Rate,SUM(ht.unloading * hrm.unloading) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unloading <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.unloading,hrm.unloading union all SELECT ht.crop_type as Section,3 as ActNo,'Sorting' as Activities,ht.Bag_Weight,ht.sorting as Number,hrm.sorting as Rate,SUM(ht.sorting * hrm.sorting) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.sorting <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.sorting,hrm.sorting union all SELECT ht.crop_type as Section,4 as ActNo,'Stiching' as Activities,ht.Bag_Weight,ht.stiching as Number,hrm.stiching as Rate,SUM(ht.stiching * hrm.stiching) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.stiching <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.stiching,hrm.stiching union all SELECT ht.crop_type as Section,5 as ActNo,'Stacking' as Activities,ht.Bag_Weight,ht.stacking as Number,hrm.stacking as Rate,SUM(ht.stacking * hrm.stacking) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.stacking <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.stacking,hrm.stacking union all SELECT ht.crop_type as Section,6 as ActNo,'Restacking' as Activities,ht.Bag_Weight,ht.restacking as Number,hrm.restacking as Rate,SUM(ht.restacking * hrm.restacking) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.restacking <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.restacking,hrm.restacking union all SELECT ht.crop_type as Section,7 as ActNo,'Weighing' as Activities,ht.Bag_Weight,ht.weighing as Number,hrm.weighing as Rate,SUM(ht.weighing * hrm.weighing) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.weighing <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.weighing,hrm.weighing union all SELECT ht.crop_type as Section,8 as ActNo,'Bundle_Preparation' as Activities,ht.Bag_Weight,ht.bundle_preparation as Number,hrm.bundle_preparation as Rate,SUM(ht.bundle_preparation * hrm.bundle_preparation) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.bundle_preparation <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.bundle_preparation,hrm.bundle_preparation union all SELECT ht.crop_type as Section,9 as ActNo,'Opening_Feeding' as Activities,ht.Bag_Weight,ht.opening_feeding as Number,hrm.opening_feeding as Rate,SUM(ht.opening_feeding * hrm.opening_feeding) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.opening_feeding <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.opening_feeding,hrm.opening_feeding union all SELECT ht.crop_type as Section,10 as ActNo,'Loading_Unloading' as Activities,ht.Bag_Weight,ht.loading_unloading as Number,hrm.loading_unloading as Rate,SUM(ht.loading_unloading * hrm.loading_unloading) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.loading_unloading <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.loading_unloading,hrm.loading_unloading union all SELECT ht.crop_type as Section,11 as ActNo,'Unp_Recd_Unl_Wt_Stk' as Activities,ht.Bag_Weight,ht.unp_recd_unl_wt_stk as Number,hrm.unp_recd_unl_wt_stk as Rate,SUM(ht.unp_recd_unl_wt_stk * hrm.unp_recd_unl_wt_stk) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unp_recd_unl_wt_stk <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.unp_recd_unl_wt_stk,hrm.unp_recd_unl_wt_stk union all SELECT ht.crop_type as Section,12 as ActNo,'Unp_Recd_Unl_Srt_Wt_Stk' as Activities,ht.Bag_Weight,ht.unp_recd_unl_srt_wt_stk as Number,hrm.unp_recd_unl_srt_wt_stk as Rate,SUM(ht.unp_recd_unl_srt_wt_stk * hrm.unp_recd_unl_srt_wt_stk) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unp_recd_unl_srt_wt_stk <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.unp_recd_unl_srt_wt_stk,hrm.unp_recd_unl_srt_wt_stk union all SELECT ht.crop_type as Section,13 as ActNo,'Dh_To_Ac_Stk' as Activities,ht.Bag_Weight,ht.dh_to_ac_stk as Number,hrm.dh_to_ac_stk as Rate,SUM(ht.dh_to_ac_stk * hrm.dh_to_ac_stk) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.dh_to_ac_stk <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.dh_to_ac_stk,hrm.dh_to_ac_stk union all SELECT ht.crop_type as Section,14 as ActNo,'Ac_To_Dh_Stk' as Activities,ht.Bag_Weight,ht.ac_to_dh_stk as Number,hrm.ac_to_dh_stk as Rate,SUM(ht.ac_to_dh_stk * hrm.ac_to_dh_stk) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.ac_to_dh_stk <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.ac_to_dh_stk,hrm.ac_to_dh_stk union all SELECT ht.crop_type as Section,15 as ActNo,'Loading_Dh' as Activities,ht.Bag_Weight,ht.loading_dh as Number,hrm.loading_dh as Rate,SUM(ht.loading_dh * hrm.loading_dh) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.loading_dh <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.loading_dh,hrm.loading_dh union all SELECT ht.crop_type as Section,16 as ActNo,'UnLoading_Dh' as Activities,ht.Bag_Weight,ht.unloading_dh as Number,hrm.unloading_dh as Rate,SUM(ht.unloading_dh * hrm.unloading_dh) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.unloading_dh <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.unloading_dh,hrm.unloading_dh union all SELECT ht.crop_type as Section,17 as ActNo,'Varai' as Activities,ht.Bag_Weight,ht.varai as Number,hrm.varai as Rate,SUM(ht.varai * hrm.varai) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode   and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = " & v(2).ToString & " AND ht.tran_date BETWEEN " & v(0).ToString & " AND " & v(1).ToString & " and ht.crop_type like(" & v(3).ToString & ") and ht.contractor_code=" & v(4).ToString & "  and ht.approval='approve' and ht.varai <> 0 GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.varai,hrm.varai order by ht.crop_type"

                            Call GetDataByDr(qry)
                            If DataDr.HasRows Then
                                GridView1.DataSource = DataDr
                                GridView1.DataBind()
                            End If
                            DataDr.Close()
                            DataDr = Nothing
                            con.Close()


                            For Each Title As GridViewRow In GridView1.Rows
                                Title.Cells(0).Attributes.Add("Title", "SrNo")
                                Title.Cells(1).Attributes.Add("Title", "Section")
                                Title.Cells(2).Attributes.Add("Title", "ActNo")
                                Title.Cells(3).Attributes.Add("Title", "Operation_Activities")
                                Title.Cells(4).Attributes.Add("Title", "Bag_Weight")
                                'Title.Cells(5).Attributes.Add("Title", "Distance_Range")
                                Title.Cells(5).Attributes.Add("Title", "Number")
                                Title.Cells(6).Attributes.Add("Title", "Rate")
                                Title.Cells(7).Attributes.Add("Title", "Amount_Rs")
                            Next

                            '*****code s end here

                            Dim sw1 As New StringWriter
                            Dim htw1 As New HtmlTextWriter(sw1)
                            GridView1.RenderControl(htw1)
                            returnValue.Append("Sixth|")
                            returnValue.Append(sw1.ToString())


                        End If


                End Select
            End If

        Catch ex As Exception
            ''MsgBox(ex.Message) ''Commented this on 09-12-2019 as this MsgBox will create the concer Showing a modal dialog box or form when the application is not running in UserInteractive mode is not a valid operation. Specify the ServiceNotification or DefaultDesktopOnly style to display a notification from a service application.
            Response.Write("<script language='javascript'>window.alert('Invalid Values');window.location='MenuPage.aspx';</script>")
        Finally
            If con.State = Data.ConnectionState.Open Then con.Close()
        End Try

    End Sub
    Protected Sub GridView1_RowDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles GridView1.RowDataBound
        If Session("plantCode").ToString = "1157" Then

            If e.Row.RowType = DataControlRowType.DataRow Then
                ' add the UnitPrice and QuantityTotal to the running total variables
                'BagWight += Convert.ToDecimal(DataBinder.Eval(e.Row.DataItem, "Bag_Weight"))
                Number += Convert.ToDecimal(DataBinder.Eval(e.Row.DataItem, "Number"))
                'Rate += Convert.ToDecimal(DataBinder.Eval(e.Row.DataItem, "Rate"))
                Amount += Convert.ToDecimal(DataBinder.Eval(e.Row.DataItem, "Amount_Rs"))

            ElseIf e.Row.RowType = DataControlRowType.Footer Then
                e.Row.Cells(0).Text = "Totals:"
                ' for the Footer, display the running totals
                'e.Row.Cells(4).Text = BagWight.ToString("")
                e.Row.Cells(6).Text = Number.ToString("")
                'e.Row.Cells(7).Text = Rate.ToString("")
                e.Row.Cells(8).Text = Amount.ToString("")


                'e.Row.Cells(4).HorizontalAlign = HorizontalAlign.Center
                e.Row.Cells(6).HorizontalAlign = HorizontalAlign.Center
                'e.Row.Cells(7).HorizontalAlign = HorizontalAlign.Center
                e.Row.Cells(8).HorizontalAlign = HorizontalAlign.Center

                e.Row.Font.Bold = True
            End If

        Else

            If e.Row.RowType = DataControlRowType.DataRow Then
                ' add the UnitPrice and QuantityTotal to the running total variables
                'BagWight += Convert.ToDecimal(DataBinder.Eval(e.Row.DataItem, "Bag_Weight"))
                Number += Convert.ToDecimal(DataBinder.Eval(e.Row.DataItem, "Number"))
                'Rate += Convert.ToDecimal(DataBinder.Eval(e.Row.DataItem, "Rate"))
                Amount += Convert.ToDecimal(DataBinder.Eval(e.Row.DataItem, "Amount_Rs"))

            ElseIf e.Row.RowType = DataControlRowType.Footer Then
                e.Row.Cells(0).Text = "Totals:"
                ' for the Footer, display the running totals
                'e.Row.Cells(4).Text = BagWight.ToString("")
                e.Row.Cells(5).Text = Number.ToString("")
                'e.Row.Cells(6).Text = Rate.ToString("")
                e.Row.Cells(7).Text = Amount.ToString("")


                'e.Row.Cells(4).HorizontalAlign = HorizontalAlign.Center
                e.Row.Cells(5).HorizontalAlign = HorizontalAlign.Center
                'e.Row.Cells(6).HorizontalAlign = HorizontalAlign.Center
                e.Row.Cells(7).HorizontalAlign = HorizontalAlign.Center

                e.Row.Font.Bold = True
            End If

        End If

    End Sub
End Class
'Protected Sub gvBilling_RowDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles gvBilling.RowDataBound

'    If e.Row.RowType = DataControlRowType.DataRow Then
'        ' add the UnitPrice and QuantityTotal to the running total variables
'        BagWight += Convert.ToDecimal(DataBinder.Eval(e.Row.DataItem, "Bag_Weight"))
'        Number += Convert.ToDecimal(DataBinder.Eval(e.Row.DataItem, "Number"))
'        Rate += Convert.ToDecimal(DataBinder.Eval(e.Row.DataItem, "Rate"))
'        Amount += Convert.ToDecimal(DataBinder.Eval(e.Row.DataItem, "Amount"))

'    ElseIf e.Row.RowType = DataControlRowType.Footer Then
'        e.Row.Cells(0).Text = "Totals:"
'        ' for the Footer, display the running totals
'        e.Row.Cells(4).Text = BagWight.ToString("")
'        e.Row.Cells(6).Text = Number.ToString("")
'        e.Row.Cells(7).Text = Rate.ToString("")
'        e.Row.Cells(8).Text = Amount.ToString("")


'        e.Row.Cells(4).HorizontalAlign = HorizontalAlign.Center
'        e.Row.Cells(6).HorizontalAlign = HorizontalAlign.Center
'        e.Row.Cells(7).HorizontalAlign = HorizontalAlign.Center
'        e.Row.Cells(8).HorizontalAlign = HorizontalAlign.Center

'        e.Row.Font.Bold = True
'    End If
'End Sub

'Protected Sub btnshow_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnshow.Click
'    ''''Dim Da As SqlDataAdapter = New SqlDataAdapter("SELECT dist_range,bag_weight,crop_type,SUM(loading) AS loading,SUM(unloading) AS unloading,SUM(weighing) AS weighing,SUM(sorting) AS sorting,SUM(stiching) AS stiching,SUM(stacking) AS stacking,SUM(restacking) AS reStacking,SUM(bundle_preparation) AS bundle_preparation,SUM(opening_feeding) AS opening_feeding,SUM(UNP_RECD_UNL_WT_STK) AS UNP_RECD_UNL_WT_STK,SUM(UNP_RECD_UNL_SRT_WT_STK) AS UNP_RECD_UNL_SRT_WT_STK,SUM(DH_To_AC_STK)As DH_To_AC_STK,SUM(AC_To_DH_STK)As AC_To_DH_STK,SUM(LOADING_DH)As LOADING_DH,SUM(UNLOADING_DH)As UNLOADING_DH FROM Hamal_trans WHERE (plantCode = '" & Session("plantCode").ToString & "') AND (tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "') and crop_type='" & cmbT.SelectedValue.ToString & "' and approval='approve' GROUP BY dist_range,bag_weight,crop_type order by crop_type ", con)
'    'Dim Da As SqlDataAdapter = New SqlDataAdapter("SELECT ht.crop_type,ham.activity,hdn.description,SUM(ht.loading * hrm.loading) AS loading,SUM(ht.unloading * hrm.unloading) As unloading,SUM(ht.sorting * hrm.sorting ) As sorting,SUM(ht.stiching * hrm.stiching) As stiching,SUM(ht.stacking * hrm.stacking) as stacking,SUM(ht.restacking * hrm.restacking) as restacking,SUM(ht.weighing * hrm.weighing) as weighing,SUM(ht.bundle_preparation * hrm.bundle_preparation ) as bundle_preparation,SUM(ht.opening_feeding * hrm.opening_feeding ) as opening_feeding,SUM(ht.loading_unloading * hrm.loading_unloading) as loading_unloading,SUM(ht.Unp_Recd_Unl_Wt_Stk * hrm.Unp_Recd_Unl_Wt_Stk) as Unp_Recd_Unl_Wt_Stk,SUM(ht.Unp_Recd_Unl_Srt_Wt_Stk * hrm.Unp_Recd_Unl_Srt_Wt_Stk) as Unp_Recd_Unl_Srt_Wt_Stk,SUM(ht.Dh_To_Ac_Stk * hrm.Dh_To_Ac_Stk) as Dh_To_Ac_Stk,SUM(ht.Ac_To_Dh_Stk * hrm.Ac_To_Dh_Stk) as Ac_To_Dh_Stk,SUM(ht.Loading_Dh * hrm.Loading_Dh) as Loading_Dh,SUM(ht.UnLoading_Dh * hrm.UnLoading_Dh) as UnLoading_Dh,SUM(ht.Varai * hrm.Varai) as Varai FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.bag_weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range WHERE  ht.plantCode = '" & Session("plantCode").ToString & "' AND ht.tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and ht.crop_type like('" & cmbT.SelectedValue.ToString & "') and ht.approval='approve' GROUP BY ht.crop_type,ham.activity,hdn.description ", con)

'    Dim Da As SqlDataAdapter = New SqlDataAdapter("SELECT ht.crop_type as Section,1 as ActNo,'Loading' as Activities,ht.Bag_Weight,hdn.description as Distance_Range,ht.loading as Number,hrm.loading as Rate,SUM(ht.loading * hrm.loading) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = '" & Session("plantCode").ToString & "' AND ht.tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and ht.crop_type like('" & cmbT.SelectedValue.ToString & "') and ht.approval='approve' GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.loading,hrm.loading union all SELECT ht.crop_type as Section,2 as ActNo,'UnLoading' as Activities,ht.Bag_Weight,hdn.description as Distance_Range,ht.unloading as Number,hrm.unloading as Rate,SUM(ht.unloading * hrm.unloading) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = '" & Session("plantCode").ToString & "' AND ht.tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and ht.crop_type like('" & cmbT.SelectedValue.ToString & "') and ht.approval='approve' GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.unloading,hrm.unloading union all SELECT ht.crop_type as Section,3 as ActNo,'Sorting' as Activities,ht.Bag_Weight,hdn.description as Distance_Range,ht.sorting as NoOfbag,hrm.sorting as Rate,SUM(ht.sorting * hrm.sorting) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = '" & Session("plantCode").ToString & "' AND ht.tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and ht.crop_type like('" & cmbT.SelectedValue.ToString & "') and ht.approval='approve' GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.sorting,hrm.sorting union all SELECT ht.crop_type as Section,4 as ActNo,'Stiching' as Activities,ht.Bag_Weight,hdn.description as Distance_Range,ht.stiching as NoOfbag,hrm.stiching as Rate,SUM(ht.stiching * hrm.stiching) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = '" & Session("plantCode").ToString & "' AND ht.tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and ht.crop_type like('" & cmbT.SelectedValue.ToString & "') and ht.approval='approve' GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.stiching,hrm.stiching union all SELECT ht.crop_type as Section,5 as ActNo,'Stacking' as Activities,ht.Bag_Weight,hdn.description as Distance_Range,ht.stacking as NoOfbag,hrm.stacking as Rate,SUM(ht.stacking * hrm.stacking) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = '" & Session("plantCode").ToString & "' AND ht.tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and ht.crop_type like('" & cmbT.SelectedValue.ToString & "') and ht.approval='approve' GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.stacking,hrm.stacking union all SELECT ht.crop_type as Section,6 as ActNo,'Restacking' as Activities,ht.Bag_Weight,hdn.description as Distance_Range,ht.restacking as NoOfbag,hrm.restacking as Rate,SUM(ht.restacking * hrm.restacking) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = '" & Session("plantCode").ToString & "' AND ht.tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and ht.crop_type like('" & cmbT.SelectedValue.ToString & "') and ht.approval='approve' GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.restacking,hrm.restacking union all SELECT ht.crop_type as Section,7 as ActNo,'Weighing' as Activities,ht.Bag_Weight,hdn.description as Distance_Range,ht.weighing as NoOfbag,hrm.weighing as Rate,SUM(ht.weighing * hrm.weighing) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = '" & Session("plantCode").ToString & "' AND ht.tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and ht.crop_type like('" & cmbT.SelectedValue.ToString & "') and ht.approval='approve' GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.weighing,hrm.weighing union all SELECT ht.crop_type as Section,8 as ActNo,'Bundle_Preparation' as Activities,ht.Bag_Weight,hdn.description as Distance_Range,ht.bundle_preparation as NoOfbag,hrm.bundle_preparation as Rate,SUM(ht.bundle_preparation * hrm.bundle_preparation) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = '" & Session("plantCode").ToString & "' AND ht.tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and ht.crop_type like('" & cmbT.SelectedValue.ToString & "') and ht.approval='approve' GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.bundle_preparation,hrm.bundle_preparation union all SELECT ht.crop_type as Section,9 as ActNo,'Opening_Feeding' as Activities,ht.Bag_Weight,hdn.description as Distance_Range,ht.opening_feeding as NoOfbag,hrm.opening_feeding as Rate,SUM(ht.opening_feeding * hrm.opening_feeding) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = '" & Session("plantCode").ToString & "' AND ht.tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and ht.crop_type like('" & cmbT.SelectedValue.ToString & "') and ht.approval='approve' GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.opening_feeding,hrm.opening_feeding union all SELECT ht.crop_type as Section,10 as ActNo,'Loading_Unloading' as Activities,ht.Bag_Weight,hdn.description as Distance_Range,ht.loading_unloading as NoOfbag,hrm.loading_unloading as Rate,SUM(ht.loading_unloading * hrm.loading_unloading) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = '" & Session("plantCode").ToString & "' AND ht.tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and ht.crop_type like('" & cmbT.SelectedValue.ToString & "') and ht.approval='approve' GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.loading_unloading,hrm.loading_unloading union all SELECT ht.crop_type as Section,11 as ActNo,'Unp_Recd_Unl_Wt_Stk' as Activities,ht.Bag_Weight,hdn.description as Distance_Range,ht.unp_recd_unl_wt_stk as NoOfbag,hrm.unp_recd_unl_wt_stk as Rate,SUM(ht.unp_recd_unl_wt_stk * hrm.unp_recd_unl_wt_stk) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = '" & Session("plantCode").ToString & "' AND ht.tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and ht.crop_type like('" & cmbT.SelectedValue.ToString & "') and ht.approval='approve' GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.unp_recd_unl_wt_stk,hrm.unp_recd_unl_wt_stk union all SELECT ht.crop_type as Section,12 as ActNo,'Unp_Recd_Unl_Srt_Wt_Stk' as Activities,ht.Bag_Weight,hdn.description as Distance_Range,ht.unp_recd_unl_srt_wt_stk as NoOfbag,hrm.unp_recd_unl_srt_wt_stk as Rate,SUM(ht.unp_recd_unl_srt_wt_stk * hrm.unp_recd_unl_srt_wt_stk) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = '" & Session("plantCode").ToString & "' AND ht.tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and ht.crop_type like('" & cmbT.SelectedValue.ToString & "') and ht.approval='approve' GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.unp_recd_unl_srt_wt_stk,hrm.unp_recd_unl_srt_wt_stk union all SELECT ht.crop_type as Section,13 as ActNo,'Dh_To_Ac_Stk' as Activities,ht.Bag_Weight,hdn.description as Distance_Range,ht.dh_to_ac_stk as NoOfbag,hrm.dh_to_ac_stk as Rate,SUM(ht.dh_to_ac_stk * hrm.dh_to_ac_stk) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = '" & Session("plantCode").ToString & "' AND ht.tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and ht.crop_type like('" & cmbT.SelectedValue.ToString & "') and ht.approval='approve' GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.dh_to_ac_stk,hrm.dh_to_ac_stk union all SELECT ht.crop_type as Section,14 as ActNo,'Ac_To_Dh_Stk' as Activities,ht.Bag_Weight,hdn.description as Distance_Range,ht.ac_to_dh_stk as NoOfbag,hrm.ac_to_dh_stk as Rate,SUM(ht.ac_to_dh_stk * hrm.ac_to_dh_stk) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = '" & Session("plantCode").ToString & "' AND ht.tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and ht.crop_type like('" & cmbT.SelectedValue.ToString & "') and ht.approval='approve' GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.ac_to_dh_stk,hrm.ac_to_dh_stk union all SELECT ht.crop_type as Section,15 as ActNo,'Loading_Dh' as Activities,ht.Bag_Weight,hdn.description as Distance_Range,ht.loading_dh as NoOfbag,hrm.loading_dh as Rate,SUM(ht.loading_dh * hrm.loading_dh) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = '" & Session("plantCode").ToString & "' AND ht.tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and ht.crop_type like('" & cmbT.SelectedValue.ToString & "') and ht.approval='approve' GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.loading_dh,hrm.loading_dh union all SELECT ht.crop_type as Section,16 as ActNo,'UnLoading_Dh' as Activities,ht.Bag_Weight,hdn.description as Distance_Range,ht.unloading_dh as NoOfbag,hrm.unloading_dh as Rate,SUM(ht.unloading_dh * hrm.unloading_dh) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = '" & Session("plantCode").ToString & "' AND ht.tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and ht.crop_type like('" & cmbT.SelectedValue.ToString & "') and ht.approval='approve' GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.unloading_dh,hrm.unloading_dh union all SELECT ht.crop_type as Section,17 as ActNo,'Varai' as Activities,ht.Bag_Weight,hdn.description as Distance_Range,ht.varai as NoOfbag,hrm.varai as Rate,SUM(ht.varai * hrm.varai) AS Amount FROM  Hamal_trans AS ht inner join Hamal_Rate_Master AS hrm on hrm.plantCode = ht.plantCode and hrm.activity=ht.activity_id and hrm.distance=ht.dist_range and hrm.weight=ht.Bag_Weight and ht.tran_date between hrm.fromdaterang and hrm.todaterang inner join Hamal_Activity_Master as ham on ht.activity_id=ham.activity_id inner join Hamal_DL_Norms as hdn on ht.dist_range=hdn.range inner join Hamali_Contractor_Master as hcm on ht.contractor_code=hcm.contractor_code and ht.plantcode=hcm.plant_code WHERE  ht.plantCode = '" & Session("plantCode").ToString & "' AND ht.tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and ht.crop_type like('" & cmbT.SelectedValue.ToString & "') and ht.approval='approve' GROUP BY ht.crop_type,ht.Bag_Weight,hdn.description,ht.varai,hrm.varai order by ht.crop_type", con)

'    Dim DsS As DataSet = New DataSet
'    Da.Fill(DsS)

'    gvBilling.DataSource = DsS.Tables(0)
'    gvBilling.DataBind()

'    gvBilling.Visible = True

'    For Each Title As GridViewRow In gvBilling.Rows
'        Title.Cells(0).Attributes.Add("Title", "SrNo")
'        Title.Cells(1).Attributes.Add("Title", "Section")
'        Title.Cells(2).Attributes.Add("Title", "ActNo")
'        Title.Cells(3).Attributes.Add("Title", "Activities")
'        Title.Cells(4).Attributes.Add("Title", "Bag_Weight")
'        Title.Cells(5).Attributes.Add("Title", "Distance_Range")
'        Title.Cells(6).Attributes.Add("Title", "NoOfbag")
'        Title.Cells(7).Attributes.Add("Title", "Rate")
'        Title.Cells(8).Attributes.Add("Title", "Amount")
'    Next


'End Sub


'Protected Sub btnShowReport_ServerClick(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnShowReport.ServerClick
'    Dim Da As SqlDataAdapter = New SqlDataAdapter("SELECT dist_range, bag_weight,crop_type,SUM(loading) AS loading,SUM(unloading) AS unloading,SUM(weighing) AS weighing,SUM(sorting) AS sorting,SUM(stiching) AS stiching,SUM(stacking) AS stacking,SUM(restacking) AS reStacking,SUM(bundle_preparation) AS bundle_preparation,SUM(opening_feeding) AS opening_feeding,SUM(UNP_RECD_UNL_WT_STK) AS UNP_RECD_UNL_WT_STK,SUM(UNP_RECD_UNL_SRT_WT_STK) AS UNP_RECD_UNL_SRT_WT_STK,SUM(heightDiff)As heightDiff FROM Hamal_trans WHERE (plantCode = '" & Session("plantCode").ToString & "') AND (tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "') and approval='approve' GROUP BY dist_range,  bag_weight,crop_type order by crop_type ", con)
'    Dim DsS As DataSet = New DataSet
'    Da.Fill(DsS)

'    gvBilling.DataSource = DsS.Tables(0)
'    gvBilling.DataBind()

'End Sub
'' ''Call GetDataByDr("SELECT activity_id,dist_range,bag_weight,crop_type,SUM(loading) AS loading,SUM(unloading) AS unloading,SUM(weighing) AS weighing,SUM(sorting) AS sorting,SUM(stiching) AS stiching,SUM(stacking) AS stacking,SUM(restacking) AS reStacking,SUM(bundle_preparation) AS bundle_preparation,SUM(opening_feeding) AS opening_feeding,SUM(UNP_RECD_UNL_WT_STK) AS UNP_RECD_UNL_WT_STK,SUM(UNP_RECD_UNL_SRT_WT_STK) AS UNP_RECD_UNL_SRT_WT_STK,SUM(DH_To_AC_STK)As DH_To_AC_STK,SUM(AC_To_DH_STK)As AC_To_DH_STK,SUM(LOADING_DH)As LOADING_DH,SUM(UNLOADING_DH)As UNLOADING_DH,sum(Varai) as Varai FROM Hamal_trans WHERE plantCode = '1107' AND tran_date BETWEEN '" & txtFrom.Text & "' AND '" & txtTo.Text & "' and crop_type='" & cmbT.SelectedValue.ToString & "' and approval='approve' GROUP BY activity_id,dist_range,bag_weight,crop_type order by crop_type ")

'' ''Dim Act As String = ""
'' ''Dim dist As String = ""
'' ''Dim Weight As String = ""
'' ''Dim crop As String = ""
'' ''Dim Alldtl As String = ""

'' ''If DataDr.HasRows Then
'' ''    While DataDr.Read
'' ''        Act = DataDr(0) + "~"
'' ''        dist = DataDr(1) + "~"
'' ''        Weight = DataDr(2) + "~"
'' ''        crop = DataDr(3) + "~"
'' ''        Alldtl = Alldtl + Act + dist + Weight + crop
'' ''    End While
'' ''End If

'' ''DataDr.Close()
'' ''DataDr = Nothing
'' ''Dim AllAct = Alldtl.ToString.Split("~")
'' ''Dim Alldist = Alldtl.ToString.Split("||")
'' ''Dim AllWeight = Alldtl.ToString.Split("|")
'' ''Dim AllCrop = Alldtl.ToString.Split("-")

'' ''Call GetDataByDr("SELECT loading from Hamal_Rate_Master where plantCode='1107' and activity='" & AllAct.ToString & "' and  distance='" & Alldist.ToString & "' and weight='" & AllWeight.ToString & "'  ")


'' ''gvBilling.DataSource = DataDr
'' ''gvBilling.DataBind()
'' ''gvBilling.Visible = True
'' ''If con.State = Data.ConnectionState.Open Then con.Close()
'' ''If DataDr.IsClosed = False Then
'' ''    DataDr.Close()
'' ''    DataDr = Nothing
'' ''End If